<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>Warehouse style</title>
    <link rel="stylesheet" href="style.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Indie+Flower&family=Source+Sans+Pro:ital,wght@1,300&display=swap');
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Indie+Flower&family=Source+Sans+Pro:ital,wght@1,300&display=swap" rel="stylesheet">
</head>

<body id="body">
  <div id="app">
      <div id="title">
          <h1>Warehouse orders</h1>
      </div>
      <header class="topnav">
        <a class="menu-item" href="index.html">Home</a>
        <a class="menu-item" href="htcontact.html">Contact</a>
        <a class="menu-item" href="htstock.html">Stock</a>
        <a class="menu-item" href="htorders.html">Orders</a>
    </header>

    <div class="flex" id="main">
        <div class="flex fullBa" id="filters">
            <div id="searchBar">
                <input type="text" id="searchInput" v-model="searchInput" v-on:keyup="search()" value="" placeholder="Search for an order">
            </div>
            <div class="flex" id="autoFilters">
                <div class="autoFilters" @click="doFilters('new')">Sort by date <br> (newest first)</div>
                <div class="autoFilters" @click="doFilters('old')">Sort by date <br> (oldest first)</div>
            </div>
        </div>
        <div class="flex fullBa" id="beerListe">
          <div class="beer" v-for="b in beersToDisplay" @click="showBeer(b)">{{b.order}} - {{b.date}} - {{b.quantity}}</div>
        </div>
  </div>


  <div v-if="displayBeer" id="beerShow">
      <span id="closeBeer" @click="closeBeer()">X</span>
      <div class="flex" id="beerContact">
          <div id="headerBeer">
              Details about the order: {{currentBeer.order}}
          </div>
          <div class="beerInfo flex">
              <span>Name:</span>
              <span>{{currentBeer.order}}</span>
          </div>
          <div class="beerInfo flex">
              <span>Date:</span>
              <span>{{currentBeer.date}}</span>
          </div>
          <div class="beerInfo flex">
              <span>Client name</span>
              <span>{{currentBeer.client}}</span>
          </div>
          <div class="beerInfo flex">
              <span>Client address</span>
              <span>{{currentBeer.address}}</span>
          </div>
        <div class="beerInfo flex">
            <span>Beer</span>
            <span>{{currentBeer.name}}</span>
        </div>
        <div class="beerInfo flex">
            <span>Quantity</span>
            <span>{{currentBeer.quantity}}</span>
        </div>
        <div>
            <label for="numberOfBeer">Has this order been delivered ?</label>
            <button type="button" >Terminate order <br></button>
        </div>
      </div>
  </div>

  <script type="text/javascript" src="vue.js"></script>
  <script>
  
  Vue.createApp({
     data(){
            return{
                   breweries:[],
                   searchInput: "",
                   beers:[], // Stock all beers
                   beersToDisplay:[], //Use for display the beer depending on the filters
                   breweryToDisplay:[],
                   currentBrewery: "",
                   currentBeer:"",
                   flagBeer: false,

                   numberbeer:10,

                   displayBrewery: false,
                   displayBeer: false,

                   orders:[],
                   orderToDisplay:[],
                   currentOrder:"",

                   serverUrl: "http://127.0.0.1:8080"
            }
     },
     comuted:{},
     methods:{
         fakeBackend(){
             const color=['Blond','red','brown','white']
             for (var i=1;i<= 10;i++){
                 var tmpBrewery = {id: i,name:'brewery_'+i, adresse:'adresse '+i, beers: []};
                 for (beer=11; beer <21; beer+=8){
                     var beerObject = {
                         brewery: tmpBrewery.id,
                         id: i*beer,
                         name: (Math.random() + 1).toString(36).substring(7), // create random name
                         color: color[Math.floor(Math.random() * color.length)],
                         alcool:(Math.random() + 4).toFixed(1),

                         date:("0" + i + ".06.2022"),
                         quantity:(Math.floor(Math.random()* (200) +1)),
                         client:("Max Muster"),
                         address: ("Musterstrasse 1, 1234 Musterstadt"),
                         order:((Math.random()+4).toString(36).substring(7)),

                         
                     }
                     tmpBrewery.beers.push(beerObject);
                     this.beers.push(beerObject);
                     this.beersToDisplay.push(beerObject);
                 }
  
                 this.breweries.push(tmpBrewery);
                 this.breweryToDisplay.push(tmpBrewery);
             }
             console.log(this.breweries)
         },

         showBeer(beer){
           if(this.displayBrewery){
               //We come a brewery so we need to keep the brewery in memory and close the brewery div
               this.flagBeer = true;
               this.displayBrewery = false;
           }
           this.currentBeer = beer;
           this.displayBeer = true;
       },
         closeBeer(){
             this.currentBeer = null;
             this.displayBeer = false;
             if(this.flagBeer){
                 this.displayBrewery = true;
             }
             this.flagBeer = false;
         },
         search(){
              this.beersToDisplay = this.beers.filter(b=>b.name.includes(this.searchInput))
              this.breweryToDisplay = this.breweries.filter(b=>b.name.includes(this.searchInput))
         },
         doFilters(filter){
             switch (filter){
                 case "A-Z":
                     this.beersToDisplay.sort((a,b)=>a.name.localeCompare(b.name));
                     break;
                 case "Z-A":
                     this.beersToDisplay.sort((a,b)=>a.name.localeCompare(b.name));
                     this.beersToDisplay.reverse();
                     break;
             }
         },

         showOrder(order){
             this.currentOrder = order;
             this.displayOrder = true;
         },
         closeOrder(){
             this.currentOrder = null;
             this.displayOrder = false;
             this.flagBeer = false;
         },

     },
     created(){
         this.fakeBackend();
     },
     beforeMount(){
  
     },
  }).mount('#app')
</script>
</body>
</html>
